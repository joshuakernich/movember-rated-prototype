<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=440, user-scalable=no">
<html>
<head>
	<title></title>
	<link href="./fontawesome-free-5.13.1-web/css/all.min.css" rel="stylesheet">
	<style type="text/css">

		@font-face {
			font-family: "BodyFont";
			src: url("./Overpass-Light.ttf");
		}

		@font-face {
		  font-family: BodyFont;
		  src: url("./Overpass-Bold.ttf");
		  font-weight: bold;
		}	

		body{
			background: #7CD6C4;

			font-family: "BodyFont";
			padding: 0px;
			margin: 0px;
			-webkit-text-size-adjust: 100%;
			-moz-text-size-adjust: 100%;
			-ms-text-size-adjust: 100%;
			text-size-adjust: 100%;
		}

		input{
			font: inherit;
			padding: 10px;
			width: 100%;
			box-sizing: border-box;
			margin-bottom: 10px;
			position: relative;
		}

		.convo{
			width: 400px;
			margin: auto;
			text-align: center;
			padding-top: 50px;
			position: relative;
			padding-bottom: 25vh;
		}

		.bit{
			margin-bottom: 10px;
			text-align: left;
			position: relative;
		}

		.bit.them p{
			position: relative;
			max-width: 80%;
		}

		.bit.them p:last-of-type:after{
			position: absolute;
			content: "";
			width: 0;
			height: 0;
			border-style: solid;
			left: 10px;
			bottom: -8px;

			border-width: 10px 10px 0px 0;
			border-color: black transparent transparent transparent;
		}

		.header{
			text-align: center;
			font-size: 20px;
			font-weight: normal;
		}

		.me p, .them p, .options p{
			display: inline-block;
			padding: 10px;
			background: black;
			color: white;
			margin: 0px;
			margin-bottom: 2px;
		}

		.me{
			text-align: right;
		}

		.me p{
			background: blue;
			margin-bottom: 0px;
		}

		

		.me:after, .options p.selected:before, .options p:last-of-type:before{
			position: absolute;
			content: "";
			width: 0;
			height: 0;
			border-style: solid;
			right: 10px;
			bottom: -10px;
			left: auto;
			border-width: 0 10px 10px 0;
			border-color: transparent blue transparent transparent;
		}

		.options p:last-of-type:after{
			position: absolute;
			content: "";
			width: 0;
			height: 0;
			border-style: solid;
			right: 11px;
			bottom: -8px;
			left: auto;
			border-width: 0 10px 10px 0;
			border-color: transparent white transparent transparent;
		}

		.options p.selected:after{
			display: none;
		}

		.options p:hover:after, .options.fail p:after{
			display: none;
		}

		.options.fail p:before{
			border-color: transparent #ff4400 transparent transparent;
			border-color: transparent #982c59 transparent transparent;
			border-color: transparent #757575 transparent transparent;
		}

		.options{
			text-align: right;
			position: relative;
		}

		.options p{
			background: white;

			border: 1px solid blue;
			display: block;
			margin-left: 20%;
			text-align: left;
			color: blue;
			border-bottom: none;
			margin-bottom: 0px;
			cursor: pointer;
		}

		.options p:hover{
			background: blue;
			color: white;
		}

		.options p.selected{
			background: blue;
			color: white;
		}

		.options p.selected.fail{
			background: #ff4400;
			border-color: #ff4400;

			

			background: #982c59;
			border-color: #982c59;

			background: #757575;
			border-color: #757575;
		}

		.options p:last-of-type{
			border-bottom: 1px solid blue;
		}

		.options p.grayed{
			background: #eee;
			color: #ccc;
		}

		.feedback{
			background: rgba(255,255,255,0.5);

			padding: 1px 15px;
			text-align: left;
			margin: 15px 0px;
			border: 1px solid black;

			padding: 0px;
			border: none;
			background: none;
		}

		

		button{
			width: 100%;
			font-family: inherit;
			font-size: inherit;
			background: white;
			border: 1px solid blue;
			color: blue;
			padding: 5px;
			outline: none;
			cursor: pointer;
		}

		button:hover{
			background: blue;
			color: white;
		}

		.bg{
			position: fixed;
			right: 0px;
			top: 10vh;
			height: 80vh;
			width: 35vw;
			background-size: cover;
			background-position: left center;
			background-repeat: no-repeat;
			opacity: 1;
			transition: left 0.5s, right 0.5s, opacity 0.5s;
			transition-timing-function: cubic-bezier(0.5,0.5,0.5,1.5);

		}

		@media only screen and (max-width: 500px) {
		  .bg {
		    width: 50vw;
		  }

		  .bg.faded{
			opacity: 0.1;
		}
		}

		.bg.left{
			background-position: right center;
			right: auto;
			left: 0px;
		}



		.bg.hidden{
			transition-timing-function: cubic-bezier(0.5,-0.5,0.5,0.5);
		}

		.bg.right.hidden{
			right: -5vw;
			opacity: 0;
		}

		.bg.left.hidden{
			left: -5vw;
			opacity: 0;
		}

		.feedback h1{
			font-weight: bold;
			font-size:20px;
			margin-bottom: 0px;
			color: blue;
			text-align: center;
		}

		.feedback h1.fail{
			color: #ff4400;
			color: #982c59; /* for blue mode*/
			color: #616161; /* gray */
		}

		.story{
			display: inline-block;
			height: 150px;
			width: 100%;
			background: rgba(255,255,255,0.3);
			margin: 0px;
			margin-bottom: 2px;
			
			box-sizing: border-box;
			border: 1px solid blue;
			position: relative;
			color: blue;
			cursor: pointer;
		}

		.story:hover, .story.selected{
			background: blue;
			color: white;
		}

		.story:before{
			content: "";
		}

		.story .bg-story{
			position: absolute;
			right: 0px;
			height: 95%;
			width: 50%;
			top: 5%;
			background-size: 220%;
			background-repeat: no-repeat;
			background-position: top left;
		}

		.story .bg-story.left{
			left: 0px;
			right: auto;
			background-position: top right;
		}

		.story h1{
			position: absolute;
			top: 0px;
			left: 140px;
			
			
			right: 0px;
			font-size: 25px;
			line-height: 25px;
			margin-bottom: 0px;
			padding-left: 10px;

			text-align: left;
			font-weight: normal;
			border-left: 2px solid blue;
			width: 200px;

			border: none;
			padding-left: 0px;
		}

		.story.selected h1, .story:hover h1{
			border-left-color: white;
		}

		.story h1:before{
			content: "Chat to ";
			display: inline;
			/*font-size: 0.7em;*/
			
		}

		.story-preview{
			
			position: absolute;
			left: 140px;
			top: 80px;
			width: 340px;
			transform: scale(0.7);
			transform-origin: top left;
		}

		.remember:before {
			content: "";
			height: 25px;
			width: 400px;
			background-image: url('./divider.png');
			background-size: 100%;
			margin-bottom: 10px;
			display: block;
		}
		
		.remember, .intention {
			margin-bottom: 10px;
		}

		.intention{
			padding-top: 15px;
			border-top: 2px solid black;
		}

		.remember .alec-list{
			margin-bottom: 15px;
		}

		.intention h1, .remember h1{
			font-size: 20px;

			margin: 0px;
			padding: 0px;
			margin-bottom: 5px;
		}

		.message{
			text-align: center;
		}

		.message b, .feedback b, .intention b, .remember b{
			
			color: #a8eadf; /*slightly lighter than background*/
			background: black;
			padding: 0px 5px;
			font-weight: normal;
		}



		.intention button{
			width: 32%;
			margin-right: 1%;
		}

		.intention button.selected{
			background: blue;
			color: white;
			outline: none;
		}


		.bit.share input{
			border: none;
			background: rgba(255,255,255,0.5);
		}

		button.selected{
			background: blue;
			color: white;
		}

		body.covid{
			background: #F7CB45;
		}

		body.covid .feedback h1.fail{
			color: #ff4400;
		}

		body.covid .options p.selected.fail{
			background: #ff4400;
			border-color: #ff4400;


		}

		body.covid .options.fail p:before{
			border-color: transparent #ff4400 transparent transparent;
		}

		body.covid .message b, body.covid .feedback b, body.covid .intention b, body.covid .remember b{
			color: #F7CB45;
		}

		.story .bg-story.left{
			background-size: 450%;
			width: 50%;
			top: 0px;
			height: 100%;
			background-position-x: -500px;
			background-position-y: -20px;
		}

		.story .bg-story.right{
			display: none;
		}

		.note{
			padding: 15px 0px;
			text-align: center;
			background: black;
			position: fixed;
			color: white;
			display: block;
			left: 0px
			right: 0px;
			bottom: 0px;
			margin: auto;
			z-index: 1;
			width: 100vw;

			display: none;
		}

		.note:after{
			content: 'OK';
			
			border: 1px solid white;
			color: white;
			padding: 5px 10px;
			display: block;
			width: 200px;
			margin: auto;
			margin-top: 10px;
		}

		.story{
			overflow: hidden;
		}


		.story:after{
			content: "";
			
			position: absolute;
			display: block;
			top: 0px;
			left: 140px;
			right: 0px;
			bottom: 0px;
			background: linear-gradient(to bottom, transparent, transparent, #FBDB83);
			opacity: 0.8;
		}

		.story.selected:after, .story:hover:after{
			
			background: linear-gradient(to bottom, transparent, transparent, blue);
		}

		.logo{
			position: relative;
			display: inline-block;
		}

		.byline{
			font-style: italic;
		    transform: rotate(-9deg);
		    font-size: 13px;
		    position: absolute;
		    left: 95px;
		    top: 95px;
		    white-space: nowrap;
		    transform-origin: 0px 0px;
		    font-weight: bold;
		}

	</style>
	<script type="text/javascript" src="./jquery-3.4.1.min.js"></script>

	<script type="text/javascript" src="./stories/covid/story-isolation.js"></script>
	<script type="text/javascript" src="./stories/covid/story-work.js"></script>
	<script type="text/javascript" src="./stories/covid/story-family.js"></script>

	<script type="text/javascript" src="./stories/uni/story-isolation.js"></script>
	<script type="text/javascript" src="./stories/uni/story-lonely.js"></script>
	<script type="text/javascript" src="./stories/uni/story-work.js"></script>

	<script type="text/javascript">

		$(function(){
			var iBit = -1;
			var pw = 'questions';
			

			var storyList = {
					is:'story-list',
					p:[
					storyUniIsolation,
					storyUniLonely,
					storyUniWork]
				};

			if(window.location.href.indexOf('covid')>-1){
				storyList.p = [storyCovidIsolation,storyCovidWork,storyCovidFamily];
				$('body').addClass('covid');
			} 

			$('.bg.left').css({'background-image':'url('+storyList.p[0].bg.left.img+')'})
			$('.bg.right').css({'background-image':'url('+storyList.p[0].bg.right.img+')'})

			var bitsIntro = [
				{is:'header',p:["<img width=300 src='logo-black.svg'/>"]},
				{is:'them',p:["I really don't think things will get better.","What's the point?"]},
				{is:'header',p:['What would you say?']},
				{is:'question',
					iCorrect:-1,
					p:[
					"There is no point to life, ultimately.",
					"This whole year is a write-off so far as I'm concerned.",
					"Don't get too caught up with it. Things will get better.",
				],f:[
					"You may be right. But this guy is struggling. Let's find some way to <b>open up the conversation</b>.",
					"You may be right. But this guy is struggling. Let's find some way to <b>open up the conversation</b>.",
					"You may be right. But this guy is struggling. Let's find some way to <b>open up the conversation</b>.",
				]},
				{is:'header',p:['Conversations can be tough.']},
				{is:'header',p:['We all get stuck sometimes.']},
				{is:'header',p:["So let's have a conversation."]},
				storyList
			]

			var bitsIntro = [
				
				{is:'them',p:["I'm really struggling, actually.","I don't know what to do."]},
				{is:'me',p:['Ummmmm...']},
				{is:'message',p:["<br>Sometimes, it's hard to know what to say.<br>But <b>a little practice</b> can help."]},
				{is:'header',p:["<div class='logo'><img width=300 src='logo-black.svg'/><p class='byline'>The tricky conversation simulator</p></div>"]},
				{is:'continue',p:["Get Started >"]},
				storyList
			]

			var bitsSegway = [
				{
					is:'header',
					p:['Great.'],
				},
				{
					is:'share'
				},
				storyList
			]

			var bits2 = [

			]

			var bits = bitsIntro;
			

			function scroll(){
				$("html, body").animate({ scrollTop: $(document).height() }, 1000);
				$('.convo').css({ 'min-height': $('.convo').height() });
			}

			function nextBit() {
				iBit++;
				var bit = bits[iBit];

				var $bit = $('<div class="bit '+bit.is+'">').appendTo($('.convo'));

				var $ps = $bit;

				if(bit.is == 'question'){
					if(!bit.tried) bit.tried = [];
					$ps = $('<div class="options">').appendTo($bit);
					for(var i in bit.p) $('<p class='+bit.tried[i]+'>'+bit.p[i]+'</p>').appendTo($ps);
				} else if(bit.is == 'story-list'){
					for(var i in bit.p){
						var $story = $('<div class="story">').appendTo($ps);
						var $left = $('<div class="bg-story left">').appendTo($story).css({backgroundImage:'url('+bit.p[i].bg.left.img+')'});
						var $right = $('<div class="bg-story right">').appendTo($story).css({backgroundImage:'url('+bit.p[i].bg.right.img+')'});

						var $preview = $('<div class="story-preview">').appendTo($story);
						var $thread = $('<div class="bit them">').appendTo($preview);
						$('<p>'+bit.p[i].thread[0].p[0]+'</p>').appendTo($thread);
						if(bit.p[i].thread[0].p[1]) $('<p>'+bit.p[i].thread[0].p[1]+'</p>').appendTo($thread);

						$('<h1>').appendTo($story).html(bit.p[i].name);

						if(bit.p[i].bg.left.thumb && bit.p[i].bg.left.thumb.y) $left.css({'background-position-y':bit.p[i].bg.left.thumb.y})
					}
				} else if (bit.is=='remember') {
					$ps = $('<div class="alec-list">').appendTo($ps);
					$('<h1>Remember</h1>').appendTo($ps);
					for(var i in bit.p){
						$('<li>'+bit.p[i]+'</li>').appendTo($ps);
					}
					$('<button>Continue</button>').appendTo($bit);
				} else if (bit.is=='intention') {

					$('<h1>In the next few days</h1>').appendTo($ps);
					for(var i in bit.p){
						$('<p>'+bit.p[i]+'</p>').appendTo($ps);
					}

					$('<h1>Are you ready to walk the talk?</h1><p>How confident do you feel in having this conversation?</p>').appendTo($bit);

					$('<button>Not yet</button>').appendTo($bit);
					$('<button>Getting there</button>').appendTo($bit);
					$("<button>I'm ready</button>").appendTo($bit);

				} else if(bit.is=='share'){
					$('<input value="conversations.movember.com" readonly>').appendTo($bit);
					$('<button><i class="fas fa-clone"></i>&nbsp;&nbsp;Copy sharing URL</button>').appendTo($bit).click(function(){
						var $btn = $(this);
						$btn.addClass('selected');
						$btn.html('<i class="fas fa-clone"></i>&nbsp;&nbsp;Sharing URL copied!');
						setTimeout(function(){
							$btn.removeClass('selected');
							$btn.html('<i class="fas fa-clone"></i>&nbsp;&nbsp;Copy sharing URL');
						},1500);
					})
				} else if (bit.is == 'continue' ){
					$('<button>'+bit.p[0]+'</button>').appendTo($ps).click(function(){
						$(this).hide();
						setTimeout(nextBit,500);
					});

				} else {
					for(var i in bit.p){
						$('<p>'+bit.p[i]+'</p>').appendTo($ps);
						if(i<(bit.p.length-1)) $ps.append('<br>');
					}
				}

				scroll();

				// all of the interaction happens here
				if(bit.is == 'question'){

					$bit.css({opacity:0,left:50,top:50}).animate({opacity:1,top:0,left:0});

					$bit.find('p').click(function(){
						$(this).addClass('selected');

						var index = $bit.find('p').index(this);
						
						bit.tried[index] = 'grayed';

						$bit.find('p').hide();
						$(this).show();
						$('.bg').addClass('faded');

						var feedbackHeader = (index==bit.iCorrect?'<h1><i class="fas fa-thumbs-up"></i> Good choice.</h1>':'<h1 class="fail"><i class="fas fa-exclamation-circle"></i> We can do better</h1>')
						$('<div class="feedback">'+feedbackHeader+'<p>'+bit.f[index]+'</p></div>').appendTo($bit);

						if(index!=bit.iCorrect){
							$ps.addClass('fail');
							$(this).addClass('fail');
							if(bit.iCorrect>-1) iBit--;
						}
						
						$('<button>Continue</button>').appendTo($bit).click(function(){
							$(this).hide();
							setTimeout( nextBit, 1000 );
						})

						scroll();

						$bit.find('.feedback').css({opacity:0}).animate({opacity:1});
						$bit.find('.feedback p, .feedback ul').css({opacity:0}).delay(1000).animate({opacity:1});
						$bit.find('button').css({opacity:0}).delay(3000).animate({opacity:1});
					});
				} else if (bit.is == 'them' ){
					$bit.find('p').each(function(i){
						$(this).css({opacity:0,left:-50,top:50}).delay(i*1000).animate({opacity:1,top:0,left:0});
					})
					setTimeout( nextBit, i*1000 + 2000 );

				} else if(bit.is == 'story-list'){					

					
					$('.bg').addClass('hidden');

					$bit.find('.story').click(function(){
						
						var me = $(this);

						var index = $bit.find('.story').index(me);

						me.addClass('selected');
						$bit.find('.story').hide();
						me.show();

						iBit = -1;
						bits = storyList.p[index].thread;

						for(var b in bits){
							bits[b].tried = [];
						}

						$('.bg.left').css({'background-image':'url('+storyList.p[index].bg.left.img+')'})
						$('.bg.right').css({'background-image':'url('+storyList.p[index].bg.right.img+')'})

						$('.bg').removeClass('hidden n1 n2 n3');
						$('.bg').removeClass('faded');
						$('.bg').addClass('n'+(index+1));

						setTimeout( nextBit, 2000 );

					});
				} else if(bit.is == 'remember'){
					$bit.find('button').click(function() {
						$(this).hide();
						setTimeout( nextBit, 1000 );
					})

					$bit.css({opacity:0,top:50}).animate({opacity:1,top:0});

				} else if(bit.is == 'intention'){
					$bit.find('button').click(function() {
						$(this).addClass('selected');
						bits = bitsSegway;
						iBit = -1;
						setTimeout( nextBit, 1000 );
					})

					$bit.css({opacity:0,top:50}).animate({opacity:1,top:0});

				} else if( bit.is == 'continue' ){

				} else {
					$bit.css({opacity:0,left:150}).animate({opacity:1,left:-20}).animate({opacity:1,left:0});
					setTimeout( nextBit, 1500 );
				}
			}

			//nextBit();

			$('.go-button').click(function() {
				if($('input').val()==btoa(pw)){
					$('.convo').empty();
					nextBit();
				} else{
					$('input').val('').animate({left:-10},100).animate({left:10},100).animate({left:0},100);
				}
			})

			$('.convo').empty();
			nextBit();
		})
		
	</script>
</head>
<body>
	<div class='bg left'></div>
	<div class='bg right'></div>
	<div class='note'><i class="fas fa-exclamation-circle"></i> <b>Scheduled Maintenance</b><br>- 28th January 3pm-6pm AEDT</div>
	<div class='convo'>
		<h2>Enter Password</h2>
		<input type='password' autocomplete="one-time-code"></input>
		<button class='go-button'>Go!</button>
	</div>
</body>
</html>